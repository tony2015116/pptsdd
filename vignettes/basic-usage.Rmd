---
title: "Basic Usage"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{basic-usage}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(pptsdd)
```

<!-- WARNING - This vignette is generated by {fusen} from dev/csv_download.Rmd: do not edit by hand -->

```{=html}
<!-- 
Run this 'development' chunk

Store every call to library() that you need to run chunks line by line, as in a classical Rmd for analysis
-->
```

```{=html}
<!--
# Description of your package

This will fill the description of your package.
Fill and run the content of this chunk, before anything else. 

Note: when you will use other flat templates, this part will be in a separate file. Do not be surprised!
-->
```

# connect_to_browser

`connect_to_browser()` is used to start selenium webdriver service. You can use this function before using `download_csv_auto()` and `download_csv_schedule()`.


```{r examples-connect_to_browser}
connect_to_browser(dest_dir = "C:/Users/Dell/Desktop/test")
```

# download_csv_auto

`download_csv_auto()` can download pig performance test station CSVs from chrome browser.


```{=html}
<!-- 
This first section shows:

- the three parts necessary for a package: 'function', 'examples' and 'tests'.  
  + Note that the three following chunks have names accordingly.

-->
```

```{=html}
<!--
Here is an example on how to use the function.
This should be a reproducible and working example
-->
```

```{r examples-download_csv_auto}
# Set parameters
stations = c("606","607")
data_date = c("2024-02-17","2024-02-18")
download_path = "C:/Users/Dell/Downloads/download_temp"
save_path = "C:/Users/Dell/Downloads/download_rename"
# Start selenium webdriver service
connect_to_browser(dest_dir = "C:/Users/Dell/Desktop/test")
# Download CSVs
download_csv_auto(browser = "chrome", 
                  url = Sys.getenv("web_url"), 
                  username = Sys.getenv("user_name"), 
                  password = Sys.getenv("user_password"),
                  csv_position = "1",
                  location = stations, 
                  data_date = data_date, 
                  download_path = download_path,
                  save_path = save_path)
```

# download_csv_schedule

`download_csv_schedule()` is used to make download task. You can download the *Yesterday* data at certain time in every day.


```{r examples-download_csv_schedule}
# Make a download task
download_csv_schedule(taskname = "ppt_csv_download",
                      schedule = "DAILY",
                      starttime = "20:00",
                      startdate = format(Sys.Date(), "%Y/%m/%d"),
                      rscript_args = list(browser = "chrome", 
                                          url = Sys.getenv("web_url"),
                                          username = Sys.getenv("user_name"),
                                          password = Sys.getenv("user_password"),
                                          location = c("606","607"),
                                          csv_position = "1",
                                          download_path = "C:/Users/Dell/Downloads/download_temp",
                                          save_path = "C:/Users/Dell/Downloads/download_rename"))
# Delete download task
taskscheduleR::taskscheduler_delete("ppt_csv_download")
# Reset selenium webdriver service
disconnect_from_browser()
```

# disconnect_from_browser

`disconnect_from_browser()` is used to reset selenium webdriver service. You can use this function after using `download_csv_auto()` and `download_csv_schedule()`.


```{r examples-disconnect_from_browser}
disconnect_from_browser()
```

# get_csv

```{r examples-get_csv}
# Download CSV data for a specific location range or date range.
get_csv(url = Sys.getenv("url"),
        username = Sys.getenv("username"),
        password = Sys.getenv("password"),
        location_min = "406",
        location_max = "407",
        date_min = "2024-02-18",
        date_max = "2024-02-19",
        download_path = "C:/Users/Dell/Downloads/download_rename", 
        show_message = TRUE)
```

# get_csv_auto

```{r examples-get_csv_auto}
# Download CSV data for a specific location or date
get_csv_auto(url = Sys.getenv("url"),
             username = Sys.getenv("username"),
             password = Sys.getenv("password"),
             location = c("607","608"),
             date = c("2024-02-18", "2024-02-19"),
             download_path = "C:/Users/Dell/Downloads/download_rename")
```

# get_csv_schedule

```{r examples-get_csv_schedule}
# Make a download task
get_csv_schedule(taskname = "ppt_csv_download",
                 schedule = "DAILY",
                 starttime = "20:00",
                 startdate = format(Sys.Date(), "%Y/%m/%d"),
                 rscript_args = list(browser = "chrome",
                                     url = Sys.getenv("url"),
                                     username = Sys.getenv("username"),
                                     password = Sys.getenv("password"),
                                     location = c("606","607"),
                                     download_path = "C:/Users/Dell/Downloads/download_rename"))
# Delete download task
taskscheduleR::taskscheduler_delete("ppt_csv_download")
# Reset selenium webdriver service
disconnect_from_browser()
```

That's it ! This the end of the documented story of our package. All components are there.


```{=html}
<!-- 
# Inflate your package

You're one inflate from paper to box.
Build your package from this very Rmd using `fusen::inflate()` 
-->
```

```{=html}
<!-- 
- Verify your `"DESCRIPTION"` file has been updated
- Verify your function is in `"R/"` directory
- Verify your test is in `"tests/testthat/"` directory
- Verify this Rmd appears in `"vignettes/"` directory 
-->
```

